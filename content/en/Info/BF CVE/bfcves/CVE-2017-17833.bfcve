<?xml version="1.0" encoding="utf-8"?>
<!--Bugs Framework (BF) Tool, I. Bojanova, NIST, 2020-2024-->
<BFCVE ID="CVE-2017-17833" Title="SLPD Double Free in OpenSLP in v1.0.2 and v1.1.0 " Description="Missing reposition of the 'result' pointer leads to a dangling pointer due to reallocation of the same object via 'sendbuf', which, when used to resize (second reallocation) the object leads to a Double Free. If exploited, this can lead to a denial of service or an arbitrary (remote) code execution.&#xD;&#xA;&#xD;&#xA;//generated//&#xD;&#xA;Missing Code to Sequential Reposition 'result' as 'sendbuf' Heap Used in Third-Party (openslp/slpd/slpd_process.c) Userland leads to Dangling Pointer ((due to reallocation of the same object via 'sendbuf')) &#xD;&#xA;&#xD;&#xA;, which propagates to Dangling Pointer Explicit Reallocate-Extend Heap Third-Party (openslp/slpd/slpd_process.c#L547) in Userland resulting in Double Deallocate &#xD;&#xA;&#xD;&#xA;. If exploited this can lead to ACE (RCE) (everything could be lost) or DOS (availability loss)." Author="Carlos Galhardo, Irena Bojanova" Date="2023-06-19T08:42:32" Score="9.8" Criteria="openslp:openslp:1.0.2" BugReport="https://dumpco.re/blog/openslp-2.0.0-double-free" CodeWithBug="https://sourceforge.net/p/openslp/mercurial/ci/151f07745901cbdba6e00e4889561b4083250da1/" CodeWithFix="https://sourceforge.net/p/openslp/mercurial/ci/151f07745901cbdba6e00e4889561b4083250da1/" CommitId="">
  <DefectWeakness Class="MAD" ClassType="_MEM" Language="C" File="openslp/slpd/slpd_process.c" Trace="" Line="">
    <Cause Type="Code">Missing Code</Cause>
    <Operation Comment="'result' as 'sendbuf'">Reposition</Operation>
    <Consequence Comment="(due to reallocation of the same object via 'sendbuf')" Type="Address">Dangling Pointer</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="openslp/slpd/slpd_process.c" Type="Source Code">Third-Party</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Weakness Class="MMN" ClassType="_MEM" Language="C" File="openslp/slpd/slpd_process.c" Trace="" Line="547">
    <Cause Type="Address">Dangling Pointer</Cause>
    <Operation>Reallocate-Extend</Operation>
    <Consequence Type="Memory Corruption/Disclosure">Double Deallocate</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Explicit</Attribute>
        <Attribute Comment="openslp/slpd/slpd_process.c#L547" Type="Source Code">Third-Party</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Failures ClassType="_FLR">
    <Cause Type="Memory Corruption/Disclosure">Double Deallocate</Cause>
    <Failure Class="ACE" Comment="(RCE) (everything could be lost)" />
    <Failure Class="DOS" Comment="(availability loss)" />
  </Failures>
</BFCVE>