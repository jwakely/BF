<?xml version="1.0" encoding="utf-8"?>
<BFCVE ID="CVE-2007-1320" Title="BitBlt Heap Buffer Overflow" Description="//generated//&#xD;&#xA;Missing Code in cirrus_invalidate_region() and others to Quantity Correct upper bound via applying &amp; s-&gt;cirrus_addr_mask in Codebase hw/cirrus_vga.cL642, 657, 674, 693-694,744-745, 771-772, 804-805, 1923, 1946 leads to Wrong Value off_cur_end&#xD;&#xA;&#xD;&#xA;, which propagates to Wrong Size in 'while (off_cur &lt; off_cur_end)' Direct pointer  Reposition in Codebase hw/cirrus_vga.c resulting in  Heap Over Bounds Pointer s-&gt;vram_offset + off_cur&#xD;&#xA;&#xD;&#xA;, which propagates to Over Bounds Pointer in  'cpu_physical_memory_set_dirty(s-&gt;vram_offset + off_cur)' Sequential   Write in Codebase hw/cirrus_vga.c resulting in   Buffer Overflow heap&#xD;&#xA;&#xD;&#xA;. If exploited this can lead to ACE." Author="Irena Bojanova" Date="2023-12-04T20:28:58" Score="7.2" Criteria="qemu:qemu" BugReport="xxx" CodeWithBug="xxx" CodeWithFix="" CommitId="">
  <DefectWeakness Class="DVR" ClassType="_INP" Language="C" File="https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL642&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL657&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL674&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL693-L694&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL744-L745&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL771-L772&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL804-L805&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL1923&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL1946" Trace="" Line="hw/cirrus_vga.cL642, 657, 674, 693-694,744-745, 771-772, 804-805, 1923, 1946">
    <Cause Comment="in cirrus_invalidate_region() and others" Type="Code">Missing Code</Cause>
    <Operation Comment="upper bound via applying &amp; s-&gt;cirrus_addr_mask">Correct</Operation>
    <Consequence Comment="off_cur_end" Type="Data">Wrong Value</Consequence>
    <Attributes>
      <Operand Name="Data">
        <Attribute Type="State">In Use</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Quantity</Attribute>
        <Attribute Comment="hw/cirrus_vga.cL642, 657, 674, 693-694,744-745, 771-772, 804-805, 1923, 1946" Type="Source Code">Codebase</Attribute>
        <Attribute Comment="Xen bare-metal hypervisor" Type="Execution Space">Bare-Metal</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Weakness Class="MAD" ClassType="_MEM" Language="C" File="https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL642&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL657&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL674&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL693-L694&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL744-L745&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL771-L772&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL804-L805&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL1923&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL1946" Trace="" Line="hw/cirrus_vga.c">
    <Cause Comment="in 'while (off_cur &lt; off_cur_end)'" Type="Data">Wrong Size</Cause>
    <Operation Comment="pointer">Reposition</Operation>
    <Consequence Comment="s-&gt;vram_offset + off_cur" Type="Address">Over Bounds Pointer</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Direct</Attribute>
        <Attribute Comment="hw/cirrus_vga.c" Type="Source Code">Codebase</Attribute>
        <Attribute Comment="Xen bare-metal hypervisor" Type="Execution Space">Bare-Metal</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Weakness Class="MUS" ClassType="_MEM" Language="C" File="https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL642&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL657&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL674&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL693-L694&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL744-L745&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL771-L772&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL804-L805&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL1923&#xD;&#xA;https://github.com/rarnu/QEMU-s5l89xx-port/commit/b2eb849d4b1fdb6f35d5c46958c7f703cf64cfef#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL1946" Trace="" Line="hw/cirrus_vga.c">
    <Cause Comment="in  'cpu_physical_memory_set_dirty(s-&gt;vram_offset + off_cur)'" Type="Address">Over Bounds Pointer</Cause>
    <Operation>Write</Operation>
    <Consequence Comment="heap" Type="Memory Corruption/Disclosure">Buffer Overflow</Consequence>
    <Attributes>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="hw/cirrus_vga.c" Type="Source Code">Codebase</Attribute>
        <Attribute Comment="Xen bare-metal hypervisor" Type="Execution Space">Bare-Metal</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Failures ClassType="_FLR">
    <Cause Type="Memory Corruption/Disclosure">Buffer Overflow</Cause>
    <Failure Class="ACE" />
  </Failures>
</BFCVE>