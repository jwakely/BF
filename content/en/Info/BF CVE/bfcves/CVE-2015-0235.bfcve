<?xml version="1.0" encoding="utf-8"?>
<!--Bugs Framework (BF) Tool, I. Bojanova, NIST, 2020-2024-->
<BFCVE ID="CVE-2015-0235" Title="GHOST in GNU glibc v2.2, and other v2.x  before v2.18" Description="Missing factor (the size of '*h_alias_ptr') while calculating the 'size_needed' size  of a buffer leads to reallocation of not enough memory, allowing a pointer reposition over its bounds, which, when used in 'strcpy()' leads to a heap buffer overflow. If exploited, this can lead to arbitrary code execution.&#xD;&#xA;&#xD;&#xA;//generated//&#xD;&#xA;Erroneous Code in 'size_needed = (sizeof (*host_addr)&#xD;&#xA; + sizeof (*h_addr_ptrs)&#xD;&#xA; + sizeof *h_alias_ptr) + strlen (name) + 1);' - missing factor  (the size of '*h_alias_ptr') to Operator Calculate  in Standard Library nss/digits_dots.c: 85-86 leads to Wrong Result &#xD;&#xA;&#xD;&#xA;, which propagates to Wrong Size  Explicit   Reallocate-Reduce in Standard Library nss/digits_dots.c: 102 resulting in  Heap Not Enough Memory &#xD;&#xA;&#xD;&#xA;, which propagates to Not Enough Memory in 'resbuf-&gt;h_name = strcpy (hostname, name);' Sequential   Reposition in Standard Library nss/digits_dots.c: 157 resulting in  Heap Over Bounds Pointer &#xD;&#xA;&#xD;&#xA;, which propagates to Over Bounds Pointer in 'resbuf-&gt;h_name = strcpy (hostname, name);' Sequential   Write in Standard Library nss/digits_dots.c: 157 resulting in  Heap Buffer Overflow &#xD;&#xA;&#xD;&#xA;. If exploited this can lead to ACE." Author="Irena Bojanova, Carlos Calhardo" Date="2023-06-16T17:33:00" Score="10.0" Criteria="gnu:glibc:*" BugReport="https://www.openwall.com/lists/oss-security/2015/01/27/9" CodeWithBug="https://www.openwall.com/lists/oss-security/2015/01/27/9" CodeWithFix="https://ftp.gnu.org/gnu/glibc/glibc-2.18.tar.bz2" CommitId="">
  <DefectWeakness Class="TCM" ClassType="_DAT" Language="C" File="nss/digits_dots.c" Trace="" Line="85-86">
    <Cause Comment="in 'size_needed = (sizeof (*host_addr)&#xA; + sizeof (*h_addr_ptrs)&#xA; + sizeof *h_alias_ptr) + strlen (name) + 1);' - missing factor  (the size of '*h_alias_ptr')" Type="Code">Erroneous Code</Cause>
    <Operation>Calculate</Operation>
    <Consequence Type="Data">Wrong Result</Consequence>
    <Attributes>
      <Operand Name="Name">
        <Attribute Comment="to size_needed" Type="State">Bound</Attribute>
      </Operand>
      <Operand Name="Data">
        <Attribute Type="Kind">Numeric</Attribute>
      </Operand>
      <Operand Name="Type">
        <Attribute Type="Kind">Primitive</Attribute>
      </Operand>
      <Operation>
        <Attribute Comment="addition '+'" Type="Mechanism">Operator</Attribute>
        <Attribute Comment="nss/digits_dots.c#L85-#L86" Type="Source Code">Standard Library</Attribute>
        <Attribute Type="Execution Space">Local</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Weakness Class="MMN" ClassType="_MEM" Language="C" File="nss/digits_dots.c" Trace="" Line="102">
    <Cause Type="Data">Wrong Size</Cause>
    <Operation>Reallocate-Reduce</Operation>
    <Consequence Type="Size">Not Enough Memory</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Explicit</Attribute>
        <Attribute Comment="nss/digits_dots.c#L102" Type="Source Code">Standard Library</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Weakness Class="MAD" ClassType="_MEM" Language="C" File="nss/digits_dots.c" Trace="" Line="157">
    <Cause Comment="in 'resbuf-&gt;h_name = strcpy (hostname, name);'" Type="Size">Not Enough Memory</Cause>
    <Operation>Reposition</Operation>
    <Consequence Type="Address">Over Bounds Pointer</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="nss/digits_dots.c#L157" Type="Source Code">Standard Library</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Weakness Class="MUS" ClassType="_MEM" Language="C" File="nss/digits_dots.c" Trace="" Line="157">
    <Cause Comment="in 'resbuf-&gt;h_name = strcpy (hostname, name);'" Type="Address">Over Bounds Pointer</Cause>
    <Operation>Write</Operation>
    <Consequence Type="Memory Corruption/Disclosure">Buffer Overflow</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="nss/digits_dots.c:#L157" Type="Source Code">Standard Library</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Failures ClassType="_FLR">
    <Cause Comment="" Type="Memory Corruption/Disclosure">Buffer Overflow</Cause>
    <Failure Class="ACE" Comment="(everything could be lost)" />
  </Failures>
</BFCVE>