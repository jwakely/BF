<?xml version="1.0" encoding="utf-8"?>
<!--Bugs Framework (BF) Tool, I. Bojanova, NIST, 2020-2024-->
<BFCVE ID="CVE-2008-4539" Title="&quot;BitBlt&quot; heap overflow in Cirrus VGA in KVM before kvm-82 and QEMU on Debian GNU/Linux and Ubuntu" Description="Erroneous verification of pointers towards a upper limit leads to use of an inconsistent size for an object, allowing a pointer reposition over its bounds, which, when used to in 'cirrus_do_copy()' leads to  a heap buffer overflow. If exploited, this can lead to arbitrary code execution.&#xD;&#xA;&#xD;&#xA;//generated//&#xD;&#xA;Erroneous Code in 'cirrus_bitblt_videotovideo_copy()  misplaced 'BLTUNSAFE(s)' check to Range Verify  in Codebase hw/cirrus_vga.cL793-796 leads to Wrong Value &#xD;&#xA;&#xD;&#xA;, which propagates to Wrong Size  Direct 'cirrus_do_copy()'  Reposition in Codebase hw/cirrus_vga.cL789-L791 resulting in  Heap Over Bounds Pointer &#xD;&#xA;&#xD;&#xA;, which propagates to Over Bounds Pointer  Direct e.g., 'cpu_physical_memory_set_dirty(s-&gt;vram_offset + off_cur)'  Write in Codebase hw/cirrus_vga.cL789-L791 resulting in   Buffer Overflow &#xD;&#xA;&#xD;&#xA;. If exploited this can lead to ACE." Author="Irena Bojanova" Date="2023-12-04T20:28:58" Score="7.2" Criteria="kvm_qumranet:kvm" BugReport="https://lists.opensuse.org/archives/list/security-announce@lists.opensuse.org/message/ENXASFOHHZPEN3NUWWAZB5OPW6E57347/" CodeWithBug="" CodeWithFix="https://github.com/rarnu/QEMU-s5l89xx-port/commit/65d35a09979e63541afc5bfc595b9f1b1b4ae069" CommitId="">
  <DefectWeakness Class="DVR" ClassType="_INP" Language="C" File="https://github.com/rarnu/QEMU-s5l89xx-port/commit/65d35a09979e63541afc5bfc595b9f1b1b4ae069#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL793-L796" Trace="" Line="793-796">
    <Cause Comment="in 'cirrus_bitblt_videotovideo_copy()  misplaced 'BLTUNSAFE(s)' check" Type="Code">Erroneous Code</Cause>
    <Operation>Verify</Operation>
    <Consequence Type="Data">Wrong Value</Consequence>
    <Attributes>
      <Operand Name="Data">
        <Attribute Type="State">In Use</Attribute>
      </Operand>
      <Operation>
        <Attribute Comment="fixed with trancation via &#xD;&#xA;'&amp; s-&gt;cirrus_addr_mask'" Type="Mechanism">Range</Attribute>
        <Attribute Comment="hw/cirrus_vga.c#L793-#L796" Type="Source Code">Codebase</Attribute>
        <Attribute Comment="Xen bare-metal hypervisor" Type="Execution Space">Bare-Metal</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Weakness Class="MAD" ClassType="_MEM" Language="C" File="https://github.com/rarnu/QEMU-s5l89xx-port/commit/65d35a09979e63541afc5bfc595b9f1b1b4ae069#diff-770cc4137e9afc7b8f2d3f16028c920ae2e674106ee89824871643bfa58f777dL789-L791" Trace="" Line="789-791">
    <Cause Type="Data">Wrong Size</Cause>
    <Operation Comment="'cirrus_do_copy()'">Reposition</Operation>
    <Consequence Type="Address">Over Bounds Pointer</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Direct</Attribute>
        <Attribute Comment="hw/cirrus_vga.c#L789-#L791" Type="Source Code">Codebase</Attribute>
        <Attribute Comment="Xen bare-metal hypervisor" Type="Execution Space">Bare-Metal</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Weakness Class="MUS" ClassType="_MEM" Language="" File="" Trace="" Line="">
    <Cause Comment="in e.g., 'cpu_physical_memory_set_dirty(s-&gt;vram_offset + off_cur)'" Type="Address">Over Bounds Pointer</Cause>
    <Operation>Write</Operation>
    <Consequence Type="Memory Corruption/Disclosure">Buffer Overflow</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Direct</Attribute>
        <Attribute Comment="hw/cirrus_vga.c#L789-#L791" Type="Source Code">Codebase</Attribute>
        <Attribute Comment="Xen bare-metal hypervisor" Type="Execution Space">Bare-Metal</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Failures ClassType="_FLR">
    <Cause Type="Memory Corruption/Disclosure">Buffer Overflow</Cause>
    <Failure Class="ACE" />
  </Failures>
</BFCVE>