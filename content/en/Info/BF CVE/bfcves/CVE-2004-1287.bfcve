<?xml version="1.0" encoding="utf-8"?>
<BFCVE ID="CVE-2004-1287" Title="Stack Buffer Overflow in NASM 0.98.38 1.2" Description="Missing verification of 'arg' towards a upper limit leads to use of an inconsistent size for an object, allowing a pointer reposition over its bounds, which, when used in ‘vsprintf()' leads to  a stack buffer overflow. If exploited, this can lead to data tampering, denial of service (application crash), or remote code execution.&#xD;&#xA;&#xD;&#xA;//generated//&#xD;&#xA;Missing Code in 'vsprintf(buff, fmt, arg)' to Quantity Verify upper bound in Codebase preproc.c:4070 leads to Inconsistent Value 'arg'&#xD;&#xA;&#xD;&#xA;, which propagates to Wrong Size 'arg' Sequential pointer  Reposition in Codebase preproc.c:4070 resulting in  Stack Over Bounds Pointer 'buff'&#xD;&#xA;&#xD;&#xA;, which propagates to Over Bounds Pointer 'buff' Sequential object  Write in Codebase preproc.c:4070 resulting in  Stack Buffer Overflow 'buff''. If exploited this can lead to Arbitrary Code Execution, or Denial of Service – availability loss, or Data Tempering – integrity loss.&#xD;&#xA;&#xD;&#xA;//updated//&#xD;&#xA;Missing Code to Verify Quantity [arg] in Codebase preproc.c:4070 results in an Inconsistent Value. Subsequently, the Wrong Size derived from [arg] is used to perform a Sequential Reposition of a pointer [buff] in Codebase preproc.c:4070, which results in an Over Bounds Pointer. Finally, using the Over Bounds Pointer [buff] to perform a Sequential Write of Moderate amount of data on the Stack in Codebase preproc.c:4070 results in a final Buffer Overflow memory error. When exploited, this vulnerability can lead to Data Tampering – integrity loss,  or Arbitrary Code Execution." Author="Kedrian James, Irena Bojanova" Date="2023-11-30T07:11:36" Score="10.0" Criteria="nasm:netwide_assembler" BugReport="https://github.com/mudongliang/LinuxFlaw/tree/0f5957b6fe8e2166287c36f9fe2534a5cdc26eca/CVE-2004-1287" CodeWithBug="https://github.com/mudongliang/LinuxFlaw/tree/0f5957b6fe8e2166287c36f9fe2534a5cdc26eca/CVE-2004-1287" CodeWithFix="" CommitId="">
  <DefectWeakness Class="DVR" ClassType="_INP" Language="C" File="" Trace="" Line="">
    <Cause Comment="in 'vsprintf(buff, fmt, arg)'" Type="Code">Missing Code</Cause>
    <Operation Comment="upper bound">Verify</Operation>
    <Consequence Comment="'arg'" Type="Data">Inconsistent Value</Consequence>
    <Attributes>
      <Operand Name="Data">
        <Attribute Type="State">Entered</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Quantity</Attribute>
        <Attribute Comment="preproc.c:4070" Type="Source Code">Codebase</Attribute>
        <Attribute Type="Execution Space">Local</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Weakness Class="MAD" ClassType="_MEM" Language="C" File="url to the line " Trace="" Line="">
    <Cause Comment="'arg'" Type="Data">Wrong Size</Cause>
    <Operation Comment="pointer">Reposition</Operation>
    <Consequence Comment="'buff'" Type="Address">Over Bounds Pointer</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Stack</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="preproc.c:4070" Type="Source Code">Codebase</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Weakness Class="MUS" ClassType="_MEM" Language="C" File="" Trace="" Line="">
    <Cause Comment="'buff'" Type="Address">Over Bounds Pointer</Cause>
    <Operation Comment="object">Write</Operation>
    <Consequence Comment="'buff'" Type="Memory Corruption/Disclosure">Buffer Overflow</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Stack</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="preproc.c:4070" Type="Source Code">Codebase</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Failures ClassType="_FLR">
    <Cause Comment="" Type="Memory Corruption/Disclosure">Buffer Overflow</Cause>
    <Failure Class="ACE" />
    <Failure Class="DOS" />
    <Failure Class="TPR" />
  </Failures>
</BFCVE>