<?xml version="1.0" encoding="utf-8"?>
<BFCVE ID="CVE-2014-0160" Title="Heartbleed Heap Buffer Over-Read in OpenSSL v1.0.1 before v1.0.1g" Description="//generated//&#xD;&#xA;&#xD;&#xA;Missing Code in 'dtls1_process_heartbeat(SSL *s)' to Verify lenght Range in Third-Party ssl /d1_both.c:1462 and ssl /t1_lib.c:2591 leads to Inconsistent Value 'payload'&#xD;&#xA;, which propagates to Wrong Size used in 'memcpy(bp, pl, payload)' for Sequential pointer Reposition in Third-Party ssl /d1_both.c:1480 and ssl /t1_lib.c:2437 resulting in  Heap Over Bounds Pointer 'pl'&#xD;&#xA;, which propagates to Sequential object Read in Third-Party ssl /d1_both.c:1480 and ssl /t1_lib.c:2437 resulting in  Heap Buffer Over-Read 'pl'. If exploited this can lead to Information Exposure – confidentiality loss.&#xD;&#xA;&#xD;&#xA;//short//&#xD;&#xA;&#xD;&#xA;Missing verification of 'payload'  towards a upper limit leads to use of an inconsistent size for an object, allowing a pointer reposition over its bounds, which, when used in 'memcpy()' leads to  a heap buffer over-read. If exploited, this can lead to exposure of sensitive information – confidentiality loss." Author="Irena Bojanova, Carlos Calhardo" Date="2023-02-10T11:16:21" Score="5.0" Criteria="openssl:openssl" BugReport="https://www.seancassidy.me/diagnosis-of-the-openssl-heartbleed-bug.html" CodeWithBug="https://git.openssl.org/?p=openssl.git;a=blob;f=ssl/d1_both.c;h=0a84f957118afa9804451add380eca4719a9765e;hb=4817504d069b4c5082161b02a22116ad75f822b1" CodeWithFix="https://github.com/openssl/openssl/commit/96db9023b881d7cd9f379b0c154650d6c108e9a3" CommitId="">
  <DefectWeakness Class="DVR" ClassType="_INP" Language="C" File="https://github.com/openssl/openssl/commit/96db9023b881d7cd9f379b0c154650d6c108e9a3#diff-6f954bc636343f76cc5f584e115159c89222b1b611fa0cac1059424e481b05b9L1463-L1465" Trace="" Line="ssl /d1_both.c: 1462&#xD;&#xA;ssl /t1_lib.c: 2591">
    <Cause Comment="in 'dtls1_process_heartbeat(SSL *s)'" Type="Code Defect">Missing Code</Cause>
    <Operation Comment="lenght">Verify</Operation>
    <Consequence Comment="'payload'" Type="Data">Inconsistent Value</Consequence>
    <Attributes>
      <Operand Name="Data">
        <Attribute Comment="via network" Type="State">Transferred</Attribute>
      </Operand>
      <Operation>
        <Attribute Comment="1 + 2 + 16  &lt;= s-&gt;s3-&gt;rrec.length&#xD;&#xA;1 + 2 + payload + 16 &lt;= s-&gt;s3-&gt;rrec.length" Type="Mechanism">Range</Attribute>
        <Attribute Comment="'ssl /d1_both.c:1462' and 'ssl /t1_lib.c:2591'" Type="Source Code">Third-Party</Attribute>
        <Attribute Type="Execution Space">Local</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Weakness Class="MAD" ClassType="_MEM" Language="C" File="https://github.com/openssl/openssl/blob/0d7717fc9c83dafab8153cbd5e2180e6e04cc802/ssl/d1_both.c#L1487;&#xD;&#xA;https://github.com/openssl/openssl/blob/96db9023b881d7cd9f379b0c154650d6c108e9a3/ssl/t1_lib.c#L2620" Trace="" Line="ssl /d1_both.c: 1480&#xD;&#xA;ssl /t1_lib.c: 2437">
    <Cause Comment="in 'memcpy(bp, pl, payload)'" Type="Data">Wrong Size</Cause>
    <Operation Comment="pointer">Reposition</Operation>
    <Consequence Comment="'pl'" Type="Address">Over Bounds Pointer</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Comment="for  s→s3→rrec.data[0]" Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="ssl /d1_both.c:1487 and ssl /t1_lib.c:2620" Type="Source Code">Third-Party</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Weakness Class="MUS" ClassType="_MEM" Language="C" File="https://github.com/openssl/openssl/blob/0d7717fc9c83dafab8153cbd5e2180e6e04cc802/ssl/d1_both.c#L1487;&#xD;&#xA;https://github.com/openssl/openssl/blob/96db9023b881d7cd9f379b0c154650d6c108e9a3/ssl/t1_lib.c#L2620" Trace="" Line="ssl /d1_both.c: 1480&#xD;&#xA;ssl /t1_lib.c: 2437">
    <Cause Comment="in 'memcpy(bp, pl, payload)'" Type="Address">Over Bounds Pointer</Cause>
    <Operation Comment="object">Read</Operation>
    <Consequence Comment="'pl'" Type="Memory Corruption/Disclosure">Buffer Over-Read</Consequence>
    <Attributes>
      <Operand Name="Address">
        <Attribute Type="State">Heap</Attribute>
      </Operand>
      <Operand Name="Size">
        <Attribute Type="Kind">Used</Attribute>
      </Operand>
      <Operation>
        <Attribute Type="Mechanism">Sequential</Attribute>
        <Attribute Comment="ssl /d1_both.c:1487 and ssl /t1_lib.c:2620" Type="Source Code">Third-Party</Attribute>
        <Attribute Type="Execution Space">Userland</Attribute>
      </Operation>
    </Attributes>
  </Weakness>
  <Failures ClassType="_FLR">
    <Cause Comment="see also:&#xD;&#xA;https://git.openssl.org/?p=openssl.git;a=blob;f=ssl/t1_lib.c;h=c5c805cce286d12d81c5fdccfe9173d61a68ee82;hb=4817504d069b4c5082161b02a22116ad75f822b1" Type="Memory Corruption/Disclosure">Buffer Over-Read</Cause>
    <Failure Class="IEX" />
  </Failures>
</BFCVE>