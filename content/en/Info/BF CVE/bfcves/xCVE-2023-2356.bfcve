<?xml version="1.0" encoding="utf-8"?>
<BFCVE ID="CVE-2023-2356" Title="Relative Path Traversal in GitHub repository mlflow/mlflow prior to 2.3.1" Description="//generated//&#xD;&#xA;Missing Code  to Safelist Validate  in Codebase mlflow/server/handlers.py:1326-1353 leads to File Injection &#xD;&#xA;&#xD;&#xA;. If exploited this can lead to IEX." Author="Eduard Pinconschi, Irena Bojanova" Date="2023-12-23T08:10:16" Score="10.0" Criteria="lfprojects:mlflow" BugReport="https://huntr.dev/bounties/7b5d130d-38eb-4133-8c7d-0dfc9a9d9896" CodeWithBug="https://github.com/mlflow/mlflow/commit/6e051028b4cd5a4c68a32f8f59819f98ff62fb80" CodeWithFix="https://github.com/mlflow/mlflow/commit/f73147496e05c09a8b83d95fb4f1bf86696c6342" CommitId="">
  <DefectWeakness Class="DVL" ClassType="_INP" Language="Python" File="https://github.com/mlflow/mlflow/blob/6e051028b4cd5a4c68a32f8f59819f98ff62fb80/mlflow/server/handlers.py#L1326-L1353" Trace="" Line="1326-1353">
    <Cause Type="Code">Missing Code</Cause>
    <Operation>Validate</Operation>
    <Consequence Type="Injection">File Injection</Consequence>
    <Attributes>
      <Operand Name="Data">
        <Attribute Comment="Codebase mlflow/server/handlers.py#L1333-L1334" Type="State">Transferred</Attribute>
      </Operand>
      <Operation>
        <Attribute Comment="Codebase mlflow/server/handlers.py#L1333-L1334 (check if run_artifact_dir in [source, *source.parents], this approach aims to ensure that only specific, valid paths are allowed)" Type="Mechanism">Safelist</Attribute>
        <Attribute Comment="mlflow/server/handlers.py:1326-1353" Type="Source Code">Codebase</Attribute>
        <Attribute Type="Execution Space">Local</Attribute>
      </Operation>
    </Attributes>
  </DefectWeakness>
  <Failures ClassType="_FLR">
    <Cause Type="Injection">File Injection</Cause>
    <Failure Class="IEX" />
  </Failures>
</BFCVE>